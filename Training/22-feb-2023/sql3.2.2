use sql_practice_3_2;

CREATE TABLE users (
 id INT PRIMARY KEY,
 name VARCHAR(255),
 created_at TIMESTAMP
);
CREATE TABLE posts (
 id INT PRIMARY KEY,
 user_id INT,
 body TEXT,
 created_at TIMESTAMP
);
CREATE TABLE likes (
 id INT PRIMARY KEY,
 user_id INT,
 post_id INT,
 created_at TIMESTAMP
);


-- insert data into users table
INSERT INTO users (id, name, created_at) VALUES
(1, 'John Doe', '2022-01-01 10:00:00'),
(2, 'Jane Smith', '2022-01-02 14:30:00'),
(3, 'Bob Johnson', '2022-01-03 08:15:00'),
(4, 'Alice Lee', '2022-01-04 12:45:00');

-- insert data into posts table
INSERT INTO posts (id, user_id, body, created_at) VALUES
(1, 1, 'Hello world!', '2022-01-01 10:30:00'),
(2, 2, 'My first blog post', '2022-01-02 15:00:00'),
(3, 1, 'Here are my thoughts on the latest news...', '2022-01-03 09:00:00'),
(4, 3, 'I have a new project in the works...', '2022-01-04 13:00:00'),
(5, 4, 'Check out my latest artwork!', '2022-01-05 11:00:00');

-- insert data into likes table
INSERT INTO likes (id, user_id, post_id, created_at) VALUES
(1, 2, 1, '2022-01-01 11:00:00'),
(2, 3, 1, '2022-01-02 16:00:00'),
(3, 1, 3, '2022-01-03 10:00:00'),
(4, 4, 5, '2022-01-05 12:00:00');

-- Write a query to retrieve the name and number of posts for each 
-- user who joined the platform in the year 2022, along with the 
-- total number of likes received for each user's posts.
select u.name , count(p.id) ,sum(l.id) from users u join posts p on u.id=p.id join likes l on p.id=l.post_id group by u.id , p.id 

